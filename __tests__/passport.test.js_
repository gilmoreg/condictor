/* eslint-disable no-unused-vars */
/* eslint-disable no-unused-expressions */
/* eslint-disable no-undef */
const chai = require('chai');
const chaiHttp = require('chai-http');
const mongoose = require('mongoose');

const { app, runServer, closeServer } = require('../server');
require('dotenv').config();

mongoose.Promise = global.Promise;
const TEST_DATABASE_URL = process.env.TEST_DATABASE_URL;
const tearDownDb = () => mongoose.connection.dropDatabase();
chai.use(chaiHttp);

describe('Passport', () => {
  beforeAll(() => runServer(TEST_DATABASE_URL));
  afterEach(() => tearDownDb());
  afterAll(() => closeServer());

  it('should create a new user and sign in', () => {
    chai.request(app)
      .post('/auth/signup')
      .send({ username: 'admin', password: 'test' })
      .then((res) => {
        expect(res.status).toEqual(201);
        console.log(res.body);
        // res.should.be.json;
        // res.body.should.be.a('object');
        // res.body.username.should.equal('admin');
      });
  });
});
